<div
  class="h-full w-full flex flex-col justify-center md:justify-end items-start md:items-center relative pb-0 pl-4 md:pl-0 md:pb-8 group outline-none"
  [style.background-color]="color()"
  [style.color]="textColor()"
  (click)="copyColor()"
  (keydown.enter)="copyColor()"
  tabindex="0"
  role="button"
>
  @if (showTools()) {
    <div
      class="absolute hidden md:flex top-2 right-2 md:left-2 md:right-auto z-10 items-center gap-1.5 px-2 py-1 rounded-full bg-black/10 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300"
      [pTooltip]="'Contrast Ratio: ' + contrastRatio().toFixed(2) + ':1'"
      tooltipPosition="top"
    >
      <span
        class="w-2 h-2 rounded-full"
        [class.bg-green-500]="wcagLevel() === 'AAA'"
        [class.bg-yellow-500]="wcagLevel() === 'AA'"
        [class.bg-red-500]="wcagLevel() === 'Fail'"
      ></span>
      <span
        class="text-[10px] font-bold tracking-tighter uppercase opacity-80"
        >{{ wcagLevel() }}</span
      >
    </div>
    <div class="absolute md:relative right-2 md:right-auto">
      <app-color-tools
        [item]="item()"
        [textColor]="textColor()"
        (remove)="delete.emit(item().id)"
        (toggleShades)="toggleShades()"
        (copyHex)="copyColor()"
        (toggleLock)="lock.emit(item().id)"
        (allowDrag)="allowDrag.emit($event)"
      ></app-color-tools>
    </div>
  }

  <div
    class="text-left md:text-center md:mt-6 transition-transform duration-300"
  >
    <h2 class="uppercase text-xl md:text-3xl font-bold m-0 tracking-widest">
      {{ colorDisplay() }}
    </h2>
    <span
      class="hidden md:block text-xs lg:text-sm font-medium mt-1 md:mt-2 opacity-60 tracking-wider"
      >{{ colorName() }}</span
    >
    <span
      class="hidden md:block text-xs lg:text-sm font-medium mt-1 opacity-0 group-hover:opacity-50 group-hover:hover:opacity-80 tracking-wider cursor-pointer transition-opacity"
      (click)="copyRgb(); $event.stopPropagation()"
      (keydown.enter)="copyRgb(); $event.stopPropagation()"
      tabindex="0"
      role="button"
      pTooltip="Click to copy RGB"
      tooltipPosition="bottom"
      >{{ rgbDisplay() }}</span
    >
    <span
      class="hidden md:block text-xs lg:text-sm font-medium mt-0.5 opacity-0 group-hover:opacity-50 group-hover:hover:opacity-80 tracking-wider cursor-pointer transition-opacity"
      (click)="copyHsl(); $event.stopPropagation()"
      (keydown.enter)="copyHsl(); $event.stopPropagation()"
      tabindex="0"
      role="button"
      pTooltip="Click to copy HSL"
      tooltipPosition="bottom"
      >{{ hslDisplay() }}</span
    >
  </div>

  @if (isShadesOpen()) {
    <div
      class="absolute inset-0 z-50 bg-white flex flex-col"
      (click)="$event.stopPropagation()"
      (keydown.esc)="toggleShades()"
      tabindex="0"
      role="dialog"
      aria-label="Color shades"
    >
      <div class="flex flex-col h-full w-full">
        @for (shade of shades(); track shade) {
          <div
            class="flex-1 min-h-0 w-full cursor-pointer relative flex items-center justify-center transition-transform hover:z-10 group/shade"
            [style.background-color]="shade"
            (click)="selectShade(shade)"
            (keydown.enter)="selectShade(shade)"
            (keydown.space)="selectShade(shade)"
            tabindex="0"
            role="button"
            title="Click to select {{ shade }}"
          >
            <!-- Hex Label (Hover) -->
            <span
              class="opacity-0 text-xs font-semibold tracking-wider pointer-events-none transition-opacity duration-200 group-hover/shade:opacity-100 absolute inset-0 flex items-center justify-center"
              [style.color]="getContrastColor(shade)"
              >{{ shade.replace('#', '').toUpperCase() }}</span
            >

            <!-- Active Indicator -->
            @if (shade.toLowerCase() === color().toLowerCase()) {
              <div
                class="w-1.5 h-1.5 rounded-full pointer-events-none opacity-80 transition-opacity duration-200 group-hover/shade:opacity-0"
                [style.background-color]="getContrastColor(shade)"
              ></div>
            }
          </div>
        }
      </div>
    </div>
  }
</div>
